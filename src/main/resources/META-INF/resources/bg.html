<!DOCTYPE html>
<html>
<head>
    <title>Node Color Counter</title>
    <script type="text/javascript" src="jquery-3.6.0.min.js"></script>

</head>

<body>
<div>
    <div>
        <span>Total calls :</span><span id="total">0</span>
    </div>
    <div>
        <span>RED :</span> <span id="red">0</span> : <span id="redp">0 %</span>
    </div>
    <div>
        <span>BLUE</span> <span id="blue">0</span> : <span id="bluep">0 %</span>
    </div>
    <div>
        <span>GREEN</span> <span id="green">0</span> : <span id="greenp">0 %</span>
    </div>
    <button id="start_timer" onclick="tmr=setInterval(callApi, 1000);">Start</button>
    <button id="stop_timer" onclick="clearInterval(tmr);">Stop</button>
</div>
<script type="text/javascript">
        var cntr=0;
        var red = 0;
        var blue=0;
        var green = 0;

        function callApi(){
            cntr++;
            var request = new XMLHttpRequest();
            request.open('GET', 'https://punctual-phoenix-kn-native-rr42724-dev.apps.sandbox-m2.ll9k.p1.openshiftapps.com/settings')
            request.send();
            request.onload = ()=>{
                var color = JSON.parse(request.response).color;
                document.getElementById("total").innerText = cntr;
                if(color == "RED"){
                    document.getElementById("red").innerText = ++red;
                    document.getElementById("redp").innerText = (red*100/(red+blue+green)) + "%";
                }
                if(color == "BLUE"){
                    document.getElementById("blue").innerText = ++blue;
                    document.getElementById("bluep").innerText = (blue*100/(red+blue+green)) + "%";
                }
                if(color == "GREEN"){
                    document.getElementById("green").innerText = ++green;
                    document.getElementById("greenp").innerText = (green*100/(red+blue+green))+ "%";
                }
            }
        }
    </script>

</body>

</html>
